<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cadastre by PCA Grade</title>
    <script src="https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v1.8.1/mapbox-gl.css" rel="stylesheet" />
    <link rel="stylesheet" href="custom.min.css" />
  </head>
  <body>
    <div id="map"></div>
    <div class="map-overlay" id="features">
      <div id="building_card"><p>Hover over a parcel!</p></div>
    </div>
    <div class="map-overlay" id="legend"><h2>Grade</h2></div>
    <script>
      mapboxgl.accessToken = 'pk.eyJ1IjoiYW50YnVybmV0dCIsImEiOiJjamw1dG1rYjcwejB0M3FxODV5MHFlNG44In0.jlI769DKp6gfC-tZlotZkQ';
      var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/antburnett/ck7cjg5u20ae41ipcrijsbw1t'
      });
      let building_data = '';
      building_data = document.getElementById('building_card');

      map.getCanvas().style.cursor = 'default';
      // map.fitBounds([
      // 	[151.2, -33.834],
      // 	[151.22, -33.854]
      // ]);
      map.on('load', function() {
        // build the legend data
        var layers = ['A', 'B', 'C', 'Other'];
        var colors = ['#ff0000', '#ffa500', '#ffff00', '#efefef'];

        // and add it to the element
        for (i = 0; i < layers.length; i++) {
          var layer = layers[i];
          var color = colors[i];
          var item = document.createElement('div');
          var key = document.createElement('span');
          key.className = 'legend-key';
          key.style.backgroundColor = color;

          var value = document.createElement('span');
          value.innerHTML = layer;
          item.appendChild(key);
          item.appendChild(value);
          legend.appendChild(item);
        }
      });

      map.on('mousemove', function(e) {
        var lots = map.queryRenderedFeatures(e.point, {
          layers: ['lots-by-grade-sample-part-2ij5d9']
        });

        if (lots.length > 0) {
          if (lots[0].properties.building_name) {
            building_data.innerHTML = '<div class="building">';
            building_data.innerHTML += '<p class="grade ' + lots[0].properties.pca_grade.toLowerCase() + '">' + lots[0].properties.pca_grade + '</p>';
            building_data.innerHTML += '<p class="building_name">' + lots[0].properties.building_name + '</p>';
            building_data.innerHTML +=
              '<p><strong>Address:</strong>' + lots[0].properties.address + ', ' + lots[0].properties.Suburb + ', ' + lots[0].properties.State + '</p>';
            building_data.innerHTML += '<p><strong>Site Area:</strong> ' + lots[0].properties.site_area + '</p>';
            building_data.innerHTML += '<p><strong>Built NLA:</strong> ' + lots[0].properties.built_nla + '</p>';
            building_data.innerHTML += '<p><strong>Owner:</strong> ' + lots[0].properties.owner + '</p>';
            building_data.innerHTML += '<p><strong>Precinct:</strong> ' + lots[0].properties.precinct + '</p>';
            building_data.innerHTML += '<p><strong>Title Details:</strong> ' + lots[0].properties.title_details + '</p>';
            building_data.innerHTML += '<p><strong>Description:</strong> ' + lots[0].properties.description + '</p>';
            // document.getElementById('building_card').innerHTML += '</ul>';
            building_data.innerHTML += '</div>';
          }
        } else {
          building_data.innerHTML = '<p>Hover over a coloured parcel!</p>';
        }
      });
    </script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-621705-43"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'UA-621705-43');
    </script>
  </body>
</html>
